<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
  <!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>숙박 list</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Free HTML5 Website Template by FreeHTML5.co"
    />
    <meta
      name="keywords"
      content="free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive"
    />
    <meta name="author" content="FreeHTML5.co" />
    <!--  링크 -->
    <link
      href="https://hangeul.pstatic.net/hangeul_static/css/nanum-barun-gothic.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" type="text/css" href="./slick/slick.css" />
    <link rel="stylesheet" type="text/css" href="./slick/slick-theme.css" />
    <!-- 모달 부트-->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script> -->
    <script src="./js/jquery.min.js"></script>
    <script type="text/javascript" src="./slick/slick.min.js"></script>

    <!-- 
	//////////////////////////////////////////////////////

	FREE HTML5 TEMPLATE 
	DESIGNED & DEVELOPED by FreeHTML5.co
		
	Website: 		http://freehtml5.co/
	Email: 			info@freehtml5.co
	Twitter: 		http://twitter.com/fh5co
	Facebook: 		https://www.facebook.com/fh5co

	//////////////////////////////////////////////////////
	-->

    <!-- Facebook and Twitter integration -->
    <meta property="og:title" content="" />
    <meta property="og:image" content="" />
    <meta property="og:url" content="" />
    <meta property="og:site_name" content="" />
    <meta property="og:description" content="" />
    <meta name="twitter:title" content="" />
    <meta name="twitter:image" content="" />
    <meta name="twitter:url" content="" />
    <meta name="twitter:card" content="" />

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="favicon.ico" />

    <link
      href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700"
      rel="stylesheet"
    />

    <!-- Animate.css -->
    <link rel="stylesheet" href="css/animate.css" />
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="css/icomoon.css" />
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="css/bootstrap.css" />
    <!-- Flexslider  -->
    <link rel="stylesheet" href="css/flexslider.css" />
    <!-- Theme style  -->
    <link rel="stylesheet" href="css/style.css" />

    <!-- Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
      <script src="js/respond.min.js"></script>
    <![endif]-->

    <!----------------------- 작업장 시작 -------------------------------->
    <script>
      var contentWayPoint = function () {
        var i = 0;
        $('.animate-box').waypoint(
          function (direction) {
            if (direction === 'down' && !$(this.element).hasClass('animated')) {
              i++;

              $(this.element).addClass('item-animate');
              setTimeout(function () {
                $('body .animate-box.item-animate').each(function (k) {
                  var el = $(this);
                  setTimeout(
                    function () {
                      var effect = el.data('animate-effect');
                      if (effect === 'fadeIn') {
                        el.addClass('fadeIn animated');
                      } else if (effect === 'fadeInLeft') {
                        el.addClass('fadeInLeft animated');
                      } else if (effect === 'fadeInRight') {
                        el.addClass('fadeInRight animated');
                      } else {
                        el.addClass('fadeInUp animated');
                      }

                      el.removeClass('item-animate');
                    },
                    k * 200,
                    'easeInOutExpo'
                  );
                });
              }, 100);
            }
          },
          { offset: '85%' }
        );
      };

      let pageNo = 1;
      const numOfRows = 12;
      let totalCount = 0;
      let cat3 = '';
      let selectArea = '';
      let selectSigungu = '';
      let moreYN = false;

      // 첫시작( 스크롤 저장 기능 넣어야할듯 )
      $(function () {
        $('.loading').hide();
        getLodgeList(pageNo);
      });

      // cat3 에 따른 목록변화 (온체인지 이벤트)
      function serviceSelect(data) {
        cat3 = data;
        pageNo = 1;
        getLodgeList(pageNo);
      }

      // area ,시군구 확인 누르면 오는곳
      function areaSelect(selectArea, selectSigungu) {
        pageNo = 1;
        getLodgeList(pageNo);
      }

      //   페이지네이션 누르면 오는곳
      //   window.onload = function () {
      //     let p = document.getElementsByClassName('pagingBtn');
      //     console.log(p);
      //     Array.from(p).forEach(function (item, i) {
      //       p[i].addEventListener('click', function (event) {
      //         console.log(event.target.attributes.value.value);
      //         pageNo = event.target.attributes.value.value;
      //         getLodgeList(pageNo);
      //       });
      //     });
      //   };

      window.onload = function () {
        let p = document.getElementsByClassName('pagingBtn');
        Array.from(p).forEach(function (item, i) {
          $('.pagingControl').on('click', p[i], function (event) {
            pageNo = event.target.attributes.value.value;
            getLodgeList(pageNo);
          });
        });
      };

      // 지역 검색 목록 ( 모달창 활용 , 지역1 => areacode)
      function areaList() {
        const apiKey =
          'LAq%2FybdsYKqtAbe1T8fBzUMyL2zn2GGMHvbKELi7l2I%2FIQs%2F0%2By%2F1wcIXgdzcF2duZszTQB0sWy5C8w%2BfXmG%2FA%3D%3D';

        $.ajax({
          url: `http://apis.data.go.kr/B551011/KorService1/areaCode1?ServiceKey=${apiKey}&numOfRows=17&pageNo=1&MobileOS=ETC&MobileApp=AppTest&_type=json`,
          type: 'get',
          dataType: 'json',
          async: false,
          success: function (data) {
            parsingData(data);
          },
          error: function () {},
          complete: function () {},
        });

        function parsingData(areaData) {
          let output = `<button class="btn btn-primary col-sm-6 modal-btn animate-box" onclick="$('.sigunguList').empty(), selectSigungu=''">전국</button>`;
          const lodgeArr = areaData.response.body.items.item;
          $.each(lodgeArr, function (i, item) {
            areaCode = item.code;
            areaName = item.name;
            // console.log(areaCode, areaName)
            output += `<button class="btn btn-primary col-sm-6 modal-btn animate-box" value="${areaCode}" onclick="selectArea = this.value, selectSigungu ='', sigunguList(selectArea)">${areaName}</button>`;
          });
          $('.areaList').html(output);
          contentWayPoint();
        }
      }

      // 시군구 검색 목록 (지역2 => sigungucode)
      function sigunguList(selectArea) {
        const apiKey =
          'LAq%2FybdsYKqtAbe1T8fBzUMyL2zn2GGMHvbKELi7l2I%2FIQs%2F0%2By%2F1wcIXgdzcF2duZszTQB0sWy5C8w%2BfXmG%2FA%3D%3D';

        $.ajax({
          url: `http://apis.data.go.kr/B551011/KorService1/areaCode1?ServiceKey=${apiKey}&areaCode=${selectArea}&numOfRows=30&pageNo=1&MobileOS=ETC&MobileApp=AppTest&_type=json`,
          type: 'get',
          dataType: 'json',
          async: false,
          success: function (data) {
            parsingData(data);
          },
          error: function () {},
          complete: function () {},
        });

        function parsingData(sigunguData) {
          let output = `<button class="btn btn-primary col-sm-4 modal-btn animate-box" onclick="selectSigungu = this.value">전체</button>`;
          const lodgeArr = sigunguData.response.body.items.item;
          $.each(lodgeArr, function (i, item) {
            sigunguCode = item.code;
            sigunguName = item.name;
            // console.log(sigunguCode, sigunguName)
            output += `<button class="btn btn-primary col-sm-4 modal-btn animate-box" value="${sigunguCode}" onclick="selectSigungu = this.value">${sigunguName}</button>`;
          });

          $('.sigunguList').html(output);
          contentWayPoint();
        }
      }

      // 리스트 ajax 받아와서 출력
      function getLodgeList(pageNo) {
        // console.log(numOfRows, pageNo, selectArea, selectSigungu, cat3);

        $('.loading').show();
        const apiKey =
          'LAq%2FybdsYKqtAbe1T8fBzUMyL2zn2GGMHvbKELi7l2I%2FIQs%2F0%2By%2F1wcIXgdzcF2duZszTQB0sWy5C8w%2BfXmG%2FA%3D%3D';
        // console.log(numOfRows, pageNo, selectArea, selectSigungu, cat3);

        $.ajax({
          url: `http://apis.data.go.kr/B551011/KorService1/areaBasedList1?numOfRows=${numOfRows}&pageNo=${pageNo}&MobileOS=ETC&MobileApp=AppTest&ServiceKey=${apiKey}&listYN=Y&arrange=A&contentTypeId=32&areaCode=${selectArea}&sigunguCode=${selectSigungu}&cat1=&cat2=&cat3=${cat3}&_type=json`,
          type: 'get',
          dataType: 'json',
          async: false,
          success: function (data) {
            if (
              data.response.body.totalCount == 0 ||
              data.response.body.totalCount == null ||
              data.response.body.totalCount == ''
            ) {
              $('#lodgeList').html(
                '자료가 없습니다. 다시 검색해 주세요 <img src="./images/nodata.jpg">'
              );
              $('.loading').hide();
              $('#paging').empty();
              contentWayPoint();
            } else {
              parsingData(data);
              parsingPaging(data);
            }
          },
          error: function () {},
          complete: function () {},
        });
        $('.loading').hide();

        // 화면 출력
        function parsingData(lodgeData) {
          let output = '';
          const lodgeArr = lodgeData.response.body.items.item;
          // console.log(lodgeArr);
          $.each(lodgeArr, function (i, item) {
            const contentId = item.contentid;
            // 숙소종류
            let serviceLodge = '';
            switch (item.cat3) {
              case 'B02010100':
                serviceLodge = '관광호텔';
                break;
              case 'B02010500':
                serviceLodge = '콘도미니엄';
                break;
              case 'B02010600':
                serviceLodge = '유스호스텔';
                break;
              case 'B02010700':
                serviceLodge = '펜션';
                break;
              case 'B02010900':
                serviceLodge = '모텔';
                break;
              case 'B02011000':
                serviceLodge = '민박';
                break;
              case 'B02011100':
                serviceLodge = '게스트하우스';
                break;
              case 'B02011200':
                serviceLodge = '홈스테이';
                break;
              case 'B02011300':
                serviceLodge = '서비스드레지던스';
                break;
              case 'B02011600':
                serviceLodge = '한옥';
            }
            // 지역
            let addr =
              item.addr1.split(' ')[0] + '&nbsp' + item.addr1.split(' ')[1];

            output += `<div class="col-md-3 col-sm-6 col-padding animate-box" data-animate-effect="fadeInLeft">`;
            output += `<div class="blog-entry">`;
            output += `<a href='detail.html?contentId=${contentId}' class="blog-img">`;
            let LodgeImg =
              item.firstimage === '' ||
              item.firstimage == null ||
              contentId == '2950408'
                ? './images/noImg.png'
                : item.firstimage;
            // console.log(LodgeImg);
            // console.log(item.title);
            output += `<img src='${LodgeImg}' class="img-responsive" alt="Free HTML5 Bootstrap Template by FreeHTML5.co"></a>`;
            output += `<div class="desc">`;
            output += `<h3><a href='detail.html?contentId=${contentId}'>${item.title}</a></h3>`;
            output += `<span><small>${addr}</small> / <small>${serviceLodge}</small> / <small> <i class="icon-comment"></i>${item.tel}</small></span>`;
            output += `<p></p><a href='detail.html?contentId=${contentId}' class="lead">자세히보기 <i class="icon-arrow-right3"></i></a></div></div></div>`;
          });

          $('#lodgeList').html(output);
          contentWayPoint();
        }
        // 페이지네이션 출력
        function parsingPaging(lodgeData) {
          const pageGroupNum = 10;
          let totalCount = lodgeData.response.body.totalCount;
          let totalPage = Math.ceil(totalCount / numOfRows);
          let pageGroup = Math.ceil(pageNo / pageGroupNum);
          let fristPage = pageNo - ((pageNo % pageGroupNum) - 1);
          if (pageNo % pageGroupNum == 0) {
            fristPage = pageNo - 9;
          }
          let lastPage = pageGroup * pageGroupNum;
          if (lastPage > totalPage) {
            lastPage = totalPage;
          }

          let output = `<ul class="pagination">`;
          output += `<li class="page-item paging Previous"><a class="page-link text-success pagingBtn" href="#" value="${
            fristPage - 1
          }">이전</a></li>`;
          for (let i = fristPage; i <= lastPage; i++) {
            output += `<li class="page-item paging"><a class="page-link text-success pagingBtn" href="#" value="${i}">${i}</a></li>`;
          }
          output += `<li class="page-item paging next"><a class="page-link text-success pagingBtn" href="#" value="${
            lastPage + 1
          }">다음</a></li>`;

          $('#paging').html(output);
          contentWayPoint();

          if (lastPage >= totalPage) {
            $('.next').remove();
          }
          if (pageGroup == 1) {
            $('.Previous').remove();
          }
        }
      }
      //  }
    </script>

    <style>
      /* 로딩 이미지 css */
      .loading img {
        position: fixed;
        top: 50%;
        left: 50%;
        z-index: 999;
        transform: translate(-50%, -50%);
      }
      /* 검색 버튼 css */
      .btnSelect {
        width: 180px;
        height: 40px;
      }
      /* 지역검색 오른쪽 */
      .areaModal {
        float: right;
      }
      /* 이미지css */
      .img-responsive {
        width: 500px;
        height: 250px;
        object-fit: cover;
      }
      .blog-entry {
        height: 400px;
      }

      /* 모달css */
      .listControl {
        padding-left: 10px;
        padding-right: 10px;
      }

      .modal-btn {
        width: 150px;
      }

      .modal-content {
        width: 1000px;
      }

      .modal-header {
        border-bottom: 1px solid var(--firstColor);
        margin: 0 20px;
      }
      .modal-footer {
        border-top: 1px solid var(--firstColor);
        margin: 0 20px;
      }
      .modal-subtitle {
        font-size: 30px;
        background-color: var(--secondColor);
        border-radius: 12px;
        text-align: center;
        margin-bottom: 10px;
      }
    </style>
  </head>

  <body>
    <!-- 모달 -->
    <div class="modal" id="areaModal">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title animate-box">지역선택</h4>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>

          <div class="modal-body">
            <div class="modal-body-left col-sm-5">
              <div class="modal-subtitle animate-box">광역시/도</div>

              <div class="listControl">
                <div class="areaList"></div>
              </div>
            </div>

            <div class="modal-body-right col-sm-7">
              <div class="modal-subtitle animate-box">시/군/구</div>

              <div class="listControl">
                <div class="sigunguList"></div>
              </div>
            </div>
          </div>

          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-primary"
              data-bs-dismiss="modal"
              onclick="areaSelect(selectArea, selectSigungu)"
            >
              확인
            </button>
            <button
              type="button"
              class="btn btn-secondar"
              data-bs-dismiss="modal"
              onclick="selectArea = '', selectSigungu='', $('.areaList').empty(), $('.sigunguList').empty()"
            >
              취소
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
  <!-- 모달 끝 -->
  <body>
    <div id="fh5co-page">
      <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
      <aside id="fh5co-aside" role="complementary" class="border js-fullheight">
        <h1 id="fh5co-logo"><a href="index.html">Goott Tour</a></h1>
        <nav id="fh5co-main-menu" role="navigation">
          <ul>
            <li><a href="index.html">Home</a></li>
            <li class="fh5co-active"><a href="blog.html">Blog</a></li>
            <li><a href="portfolio.html">Portfolio</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </nav>

        <div class="fh5co-footer">
          <p>
            <small
              ><span>&copy; 2023 Blend Free HTML5. All Rights Reserved.</span>
              <span
                >Designed by
                <a href="http://freehtml5.co/" target="_blank">FreeHTML5.co</a>
              </span>
              <span
                >Demo Images:
                <a href="https://unsplash.com/" target="_blank"
                  >Unsplash</a
                ></span
              ></small
            >
          </p>
          <ul>
            <li>
              <a href="#"><i class="icon-facebook2"></i></a>
            </li>
            <li>
              <a href="#"><i class="icon-twitter2"></i></a>
            </li>
            <li>
              <a href="#"><i class="icon-instagram"></i></a>
            </li>
            <li>
              <a href="#"><i class="icon-linkedin2"></i></a>
            </li>
          </ul>
        </div>
      </aside>
      <!-- 로딩 이미지 -->
      <div class="loading"><img src="./images/loading.gif" /></div>

      <div id="fh5co-main">
        <div class="fh5co-narrow-content">
          <h2
            class="fh5co-heading animate-box"
            data-animate-effect="fadeInLeft"
          >
            숙 박
          </h2>
          <p>
            <select
              class="serviceSelect btn btn-primary dropdown-toggle btnSelect animate-box"
              onchange="serviceSelect(this.value);"
            >
              <option value="">전체</option>
              <option value="B02010100">관광호텔</option>
              <option value="B02010500">콘도미니엄</option>
              <option value="B02010600">유스호스텔</option>
              <option value="B02010700">펜션</option>
              <option value="B02010900">모텔</option>
              <option value="B02011000">민박</option>
              <option value="B02011100">게스트하우스</option>
              <option value="B02011200">홈스테이</option>
              <option value="B02011300">서비스드레지던스</option>
              <option value="B02011600">한옥</option>
            </select>
            <a
              href="#"
              class="btn btn-primary areaModal btnSelect animate-box"
              data-bs-toggle="modal"
              data-bs-target="#areaModal"
              onclick="areaList()"
              >지역검색</a
            >
          </p>
          <div class="row row-bottom-padded-md">
            <div id="lodgeList"></div>
            <div class="pagingControl">
              <div id="paging"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- jQuery -->
    <script src="js/jquery.min.js"></script>
    <!-- jQuery Easing -->
    <script src="js/jquery.easing.1.3.js"></script>
    <!-- Bootstrap -->
    <script src="js/bootstrap.min.js"></script>
    <!-- Waypoints -->
    <script src="js/jquery.waypoints.min.js"></script>
    <!-- Flexslider -->
    <script src="js/jquery.flexslider-min.js"></script>

    <!-- MAIN JS  -->
    <script src="js/main.js"></script>
  </body>
</html>
